
\newcounter{qcntvalue}
\setcounter{qcntvalue}{5}

% Generate the table header and the empty answer row
\newcommand{\tableheader}{}
\newcommand{\answerrow}{}
\foreach \n in {1,...,\value{qcntvalue}}{
		\ifnum\n=\value{qcntvalue}
			\xdef\tableheader{\tableheader Q\n} % No '&' for the last item
			\xdef\answerrow{\answerrow\strut} % No '&' for the last item in the answer row
		\else
			\xdef\tableheader{\tableheader Q\n &} % '&' for items except for the last
			\xdef\answerrow{\answerrow & \strut} % '&' for items except for the last in the answer row
		\fi
	}
\newcolumntype{C}[1]{>{\centering\arraybackslash}m{#1}}


\section*{}
 % Targeted competences and table for grading can be set here. For example:
 { \small
  \begin{spacing}{1.2}
	  \begin{tabularx}{\textwidth}{|X|}
		  \hline
		  \parbox{\dimexpr\textwidth-2\tabcolsep\relax}{
			  \strut
			  \textbf{Couleur globale}
			  \vspace{1.2cm}
			  \strut
		  } \\
		  \hline
		  \parbox{\dimexpr\textwidth-2\tabcolsep\relax}{
			  \strut
			  \textbf{Couleur par question}
			  % \vspace{1.2cm}
			  \begin{center}
				  \renewcommand{\arraystretch}{2}
				  \begin{tabular}{| *{\value{qcntvalue}}{C{1.5cm}|} }
					  \hline
					  \tableheader \\ % Use the header constructed above
					  \hline
					  % \rule{0pt}{6ex}\answerrow \\ % Use the answer row constructed above
					  % \hline
				  \end{tabular}
			  \end{center}
		  } \\
		  \hline
		  \parbox{\dimexpr\textwidth-2\tabcolsep\relax}{
			  \strut
			  \textbf{Remarques}
		  \\\versions{}{}{}{Version EABS}
			  \vspace{1.2cm}
			  \strut
		  } \\
		  \hline
	  \end{tabularx}
  \end{spacing}
 }

\section*{Objectifs}
 % Targeted competences and table for grading can be set here. For example:
 { \small
  \begin{spacing}{1.2}
	  \begin{tabularx}{\textwidth}{|X|}
		  \hline
		  \textbf{Je suis capable de...}
		  \begin{itemize}
			  \item Item 1
			        \begin{itemize}[label={}]
				        \item sub item 1
				        \item sub item 2
			        \end{itemize}
			  \item Item 2
		  \end{itemize} \\
		  \hline
	  \end{tabularx}
  \end{spacing}
 }

